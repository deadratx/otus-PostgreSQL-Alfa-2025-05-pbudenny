# Домашняя работа по MVCC - Изменение данных

## Параметры таблицы после первоначального заполнения
Количество записей = 1 000 000  
Размер таблицы = 135MB  

## Первое обновление
Обновлено 20 записей. Autovacuum не отработал.  
Живых записей = 1 000 000  
Мертвых записей = 20  
Размер таблицы = 135MB  

## Второе обновление
Обновлено 249 записей. Autovacuum не отработал.  
Живых записей = 1 000 000  
Мертвых записей = 269  
Размер таблицы = 135MB  

## Третье обновление
Обновлено 10 001 запись. Autovacuum отработал при превышении допустимого количества мёртвых строк (параметры autovacuum_vacuum_threshold и autovacuum_vacuum_scale_factor).  
Живых записей = 1 000 000  
Мертвых записей = 0  
Размер таблицы = 148MB  

## Четвёртое обновление
Обновлено 1 000 000 запись. Autovacuum отработал при превышении допустимого количества мёртвых строк (параметры autovacuum_vacuum_threshold и autovacuum_vacuum_scale_factor).  
Живых записей = 1 000 299  
Мертвых записей = 0  
Размер таблицы = 270MB  

## Выполнение VACUUM FULL
Живых записей = 1 000 299  
Мертвых записей = 0  
Размер таблицы = 135MB  

## Пятое обновление
Обновлено 1 000 000 запись. Autovacuum отработал при превышении допустимого количества мёртвых строк (параметры autovacuum_vacuum_threshold и autovacuum_vacuum_scale_factor).  
Живых записей = 1 002 632  
Мертвых записей = 0  
Размер таблицы = 270MB  

## Обновление без AUTOVACUUM
Произведено полное обновление одного поля таблицы 5 раз. Autovacuum не отработал.  
Живых записей = 1 002 632  
Мертвых записей = 4 999 859  
Размер таблицы = 808MB  

## Включение AUTOVACUUM
Включение AUTOVACUUM привело к его запуску, через некоторое время.  
Живых записей = 1 006 454  
Мертвых записей = 0
Размер таблицы = 808MB  

## Выполнение VACUUM FULL и ANALYZE
Живых записей = 1 000 000  
Мертвых записей = 0  
Размер таблицы = 135MB

## Выводы
Без AUTOVACUUM таблица быстро заполняется "мёртвыми" записями, что негативно сказывается на производительности и использовании дискового пространства.  
При этом только выполнение VACUUM (даже VACUUM FULL) всё равно оставляет больше живых записей, чем реально есть записей в таблице.  
Их колличество выравнивается только после выполнения ANALYZE.