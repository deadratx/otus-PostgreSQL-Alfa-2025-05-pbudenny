# Домашняя работа по работе с взаимоблокировками (DEADLOCK)

## Алгоритм моделирования взаимоблокировки
1. _Транзакция 1_ обновляет запись с ID = 100.
2. _Транзакция 2_ обновляет запись с ID = 101.
3. _Транзакция 2_ обновляет запись с ID = 100. Обновление заблокировано _Транзакцией 1_.
4. _Транзакция 3_ обновляет запись с ID = 102.
5. _Транзакция 3_ обновляет запись с ID = 101. Обновление заблокировано _Транзакцией 2_.
6. _Транзакция 1_ обновляет запись с ID = 102. Обновление заблокировано _Транзакцией 3_.

_Транзакция 1_ отменена. _Транзакция 2_ и _Транзакция 3_ продолжаются и могут быть успешно завершены.

При этом в журнале появляется сообщение, что процесс из _Транзакции 1_ обнаружил взаимоблокировку с детализацией кто кого блокирует и какой тип блокировки ожидается.

## SQL скрипты
_Транзакция 1_
```SQL
BEGIN;
UPDATE PERSONNEL SET FIO = 'Steve Rogers' WHERE id = 100;
UPDATE PERSONNEL SET FIO = 'Steve Rogers' WHERE id = 102;
COMMIT;
```

_Транзакция 2_
```SQL
BEGIN;
UPDATE PERSONNEL SET FIO = 'Steve Rogers' WHERE id = 101;
UPDATE PERSONNEL SET FIO = 'Steve Rogers' WHERE id = 100;
COMMIT;
```

_Транзакция 3_
```SQL
BEGIN;
UPDATE PERSONNEL SET FIO = 'Steve Rogers' WHERE id = 102;
UPDATE PERSONNEL SET FIO = 'Steve Rogers' WHERE id = 101;
COMMIT;
```